---
// For this page also think of using NEXT/PREVIOUS page for some more functionality, but that is up to you!

import ProjectLayout from "../../layouts/ProjectLayout.astro";
//import { slide } from "astro:transitions";

interface Project {
  name: string;
  slug: string;
  description: string;
  tags: string;
  content: {
    html: string;
  };
  demo: string;
  sourceCode: string;
  image: {
    url: string;
  };
}

interface Props {
  project: Project;
}

export const prerender = true;
export async function getStaticPaths() {
  const response = await fetch(
    "https://api-ap-northeast-1.hygraph.com/v2/clt4ffy57008c08jpaguxht8t/master",
    {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Accept: "application/json/",
        //Authorization: `Bearer ${import.meta.env.HYGRAPH_TOKEN}`,
      },
      body: JSON.stringify({
        query: `
        {
          projects {
            name
            slug
            description
            tags
            content {
              html
            }
            demo
            sourceCode
            image {
              url
            }
          }
        }
      `,
      }),
    }
  );
  const projects = await response.json();
  //console.log(projects);
  const paths = projects.data.projects.map((project) => ({
    params: {
      slug: project.slug,
    },
    props: {
      project,
    },
  }));
  return paths;
}
const project = Astro.props.project;
---

<ProjectLayout title={project.name}>
  <div class="flex">
    <a class="font-Futurewave" href="/">home</a>
    <a class="font-Futurewave" href="/portfolio">/portfolio</a>
    <a class="font-Futurewave" href={`/portfolio/${project.slug}`}
      >/{project.slug}</a
    >
  </div>
  <div class="flex">
    <a class="font-Futurewave" href="/portfolio">go back</a>
  </div>

  <div class="prose prose-2xl">
  {project.name}
  {project.description}
  {project.sourceCode}
  {project.image.url}
    <p
      class="mt-5 line-clamp-3 text-sm leading-6"
      set:html={project.content.html}
    />
  </div>
</ProjectLayout>
